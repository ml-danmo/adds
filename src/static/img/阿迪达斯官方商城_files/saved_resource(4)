var isClick;function initSubscribeBtn(){if($("#mailSubscription").val().trim()==""||!$(".form-choice-btn-checked").hasClass("is-active")){$(".form-group-btn .btn-have-arrow").addClass("is-disabled");isClick=false}else{$(".form-group-btn .btn-have-arrow").removeClass("is-disabled");isClick=true}}function startEmailSignup(){sendAnalytics("link",{event_name:"EMAIL SIGNUP",signup_location:"HEADER",signup_step:"START"})}$(function(){initSubscribeBtn();$(".show-mobb > h4 > i").on("tap",function(){$(this).toggleClass("active");$(this).parents(".show-mobb").find(".login-detial ,.h4-explain").toggleClass("none")});$("#mailSubscription").blur(function(){checkHasSubscriptionEmail($("#mailSubscription"));initSubscribeBtn()});$(".form-choice-btn-checked").on("tap",function(){if($(".form-choice-btn-checked").attr("class").indexOf("is-active")<0){$("#Age").show()}else{$("#Age").hide()}});$("#subscription").on("tap",function(){if(isClick){var g=$("#mailSubscription").val();var d=base+"/member/checkSubscriptionEmailAvailable.json";var f=loxia.syncXhrGet(d,{type:1,email:g});if(f.statusCode=="member.email.null"){setValid($("#mailSubscription"),false,loxia.getLocaleMsg("message_email_null"));return false}if(f.statusCode=="member.email.error"){setValid($("#mailSubscription"),false,loxia.getLocaleMsg("message_email_error"));return false}else{if(f.statusCode=="register.loginemail.unavailable"){setValid($("#mailSubscription"),false,loxia.getLocaleMsg("message_email_repeat"));return false}else{if(f.result){if($(".form-choice-btn-checked").attr("class").indexOf("is-active")<0){$("#Age").show();return false}else{var a=base+"/index/subscription.json";var b={type:1,loginEmail:g,};var e=loxia.syncXhrPost(a,b);if(e.result){if($(".form-choice-btn-checked").attr("class").indexOf("is-active")<0){$("#Age").show();return false}else{sendAnalytics("link",{event_name:"EMAIL SIGNUP",signup_location:"HEADER",signup_step:"SUCCESS"});var c;$(".form-group-btn a").live("tap",function(h){h.preventDefault();$(this).parents(".mail-subscription-content").addClass("mail-subscription-success");c=setTimeout(function(){$(".mail-subscription-content").stop(true,true).slideUp("fast");$(".mail-subscription-content").removeClass("mail-subscription-success");$(".header-fixed").removeClass("mail-subscription-open")},20000)});$(".mail-subscription-success").live("tap",function(h){$(".mail-subscription-content").stop(true,true).slideUp("fast");$(".mail-subscription-content").removeClass("mail-subscription-success");$(".header-fixed").removeClass("mail-subscription-open");clearTimeout(c)})}}else{alert("订阅失败")}}}}}}});$(".form-choice-btn-checked .icon-checked").on("tap",function(){$(this).parents(".form-choice-btn-checked").toggleClass("is-active");var a=new Array();if(!checkHasSubscriptionEmail($("#mailSubscription"))){a.push("MAIL")}if(!$(this).parents(".form-choice-btn-checked").hasClass("is-active")){a.push("AGE")}if(a.length>0){formErrorTracking("FORM ERROR",a,"MAIL SUBSCRIPTION")}initSubscribeBtn()});$(".form-choice-btn-radio").on("tap",function(){$(this).addClass("active").siblings().removeClass("active");var a=$(this).html();$("#sex").val(a)})});
loxia.regional.zh_CN={message_enter_mailorphone:"请输入邮箱地址或手机号码",message_login_pwd_err:"邮箱地址/手机号码与密码不符,请重新输入",message_login_email_notregister:"电邮地址未注册",message_login_email_numErr:"电邮发送次数已经超过限制",message_login_email_formatErr:"邮箱格式不正确",message_loginname_err:"用户名或密码错误",message_resetpassword_err:"密码重置失败",message_message_overNumerr:"短信发送次数已经超过限制",message_message_smsCodeErr:"短信验证码错误，请重新输入",message_message_smsCodeSendErr:"短信验证码发送错误,请重试",message_enter_email:"请输入邮箱地址 ",message_enter_mobile:"请输入手机号码 ",message_email_format_err:"请输入正确的邮箱地址",message_phone_format_err:"请输入正确的手机号码",message_loginName_format_err:"请输入正确的邮箱地址/电话号码",message_nickName_format_err:"请输入正确的姓名",message_nickName_err:"请输入姓名",message_pwd_characters:"密码必须在8-20个字符之间，至少包含数字和字母",message_loginpwd_characters:"密码必须在6-20个字符之间",message_enter_pwd:"请输入密码",message_enter_old_pwd:"请输入原密码",message_enter_confirm_pwd:"请再次输入密码 ",message_enter_same_pwd:"两次密码填写不一致",message_old_new_pwd_error:"旧密码跟新密码一致,请输入新的密码",message_re_register:"该邮箱地址已注册",message_enter_same_email:"邮箱不一致",message_mobilere_register:"该手机地址已注册",message_enter_description:"请输入验证码",message_enter_msgdescription:"请输入短信验证码",message_check_agreement:"请阅读并同意协议 ",message_enter_nickName:"请输入收货人姓名",message_length_nickName:"收货人姓名必须在2-15个字符之间",message_loginname_pwd_errow:"Email地址与密码不符,请重新输入",message_member_not_exist_error:"用户不存在请重新输入",message_member_not_exist:"输入不存在的邮箱或者手机",message_member_has_bind_error:"该手机号已经被其他账号绑定",message_bind_account_failed:"绑定失败,请重新操作",message_create_memberBehaviorStatus_error:"绑定失败,请重新操作",message_register_error:"注册失败，请稍后重试!",message_codeerror:"验证码错误 ",message_telephone:"固定电话格式错误 ",message_telephonemobile:"手机和固话两者必填其一 ",message_address:"地址栏不能为空 ",message_enter_birthday:"请选择正确格式生日",message_enter_address:"请选择正确格式地址",message_name_used:"此用户名已被使用",message_email_exists:"此邮箱已存在",message_email_error:"请输入正确的电子邮箱地址",invoice_consignee_null:"请输入收取人姓名",shipping_ordercode_null:"请输入订单号",message_postcode_null:"请输入邮编",message_postcode_code:"邮编格式错误请重新输入",message_codes_email_endsuccess:"验证码已发送至您的邮箱 ",message_codes_mobile_endsuccess:"验证码已发送至您的手机 ",message_error_province:"请选择省",message_error_city:"请选择市",message_error_year:"请选择年",message_error_month:"请选择月",message_error_day:"请选择日",message_select_year:"年",message_select_month:"月",message_select_day:"日",message_error_gender:"请选择性别",message_code_error:"验证码错误,请重新输入 ",message_click_send:"获取验证码",message_email_send:"获取邮箱验证码",message_second_send:"已发送 ",message_smsCode_expired:"验证码过期，请重新获取 ",message_email_format_err:"电子邮箱格式不正确",message_verificationCode_Error:"图形验证失败，请重试",message_birthday_Error:"出生日期不能大于当前日期",message_system_error:"网络繁忙，请刷新重试",message_system_busy:"抱歉，系统繁忙，请稍后再试",message_illegal_access:"非法访问，请重试",message_register_frequently:"注册过于频繁，请稍后再试",message_login_frequently:"登录过于频繁，请稍后再试",message_login_email_length:"邮件长度不能超过32位",message_nameLength_Error:"姓名不得超过20个字符",message_mobile_null:"请输入手机验证码",message_email_null:"请输入电子邮箱地址",message_verificationCode_error:"图形验证码不正确",message_email_repeat:"抱歉，您无法订阅两次。您输入的邮箱已订阅过邮件。",message_forgetpassword_mobile_code:"您输入的手机验证码有误，请重新输入",message_forgetpassword_mobile:"手机号未注册",message_forgetpassword_email:"电子邮箱地址未注册",message_forgetpassword_email_more:"电子邮箱发送次数已经超过限制",message_forgetpassword_psw:"密码格式错误",message_member_login:"登录",message_login_success:"登录成功",message_mobile_number_error:"请输入11个数字的手机号",message_enter_new_pwd:"请输入新密码",message_select_birthday:"请选择您的生日月",message_login_prompt:"登录中...请耐心等待",message_mobile_notRegister:"手机号未注册",message_address_err:"省份和城市不匹配，请您重新选择",order_employee_wrong_password:"密码错误",order_you_may_like:"您可能也喜欢",order_my_subscription:"我的订阅",order_modification_succeeded:"修改成功",order_original_password_incorrect:"很抱歉，您输入的原密码不正确，请重试",order_original_password_incorrect2:"原密码不正确，请重新输入",order_new_password_incorrect:"很抱歉，您的新密码格式不正确，请重试",order_modify_failed:"很抱歉，修改密码失败，请重试",order_old_password_empty:"旧密码不能为空，请重新输入",order_password_length:"新密码必须在8-20个字符之间，至少包含数字和字母",order_password_same:"新密码与旧密码相同，请重新输入",order_password_again:"请再次输入新密码",order_different_password:"两次输入的新密码不一致，请重新输入",order_email_length_limit:"邮箱长度不能超过32位",order_resend:"已发送（",order_resend2:"）",order_enter_employee_id:"请输入员工号",order_get_verification_code:"获得验证码",must_be_older_than_18:"年龄需大于14岁",privacy_policy:"请您接受adidas商城法律声明和隐私政策",employee_policy:"请您接受adidas员工条款",message_employee_notexist:"该员工号不存在",message_password_err:"密码错误",message_password_null:"您的账号尚未设置密码，请选择短信快捷登陆",hype_cannot_register:"活动期间，暂停注册",this_mobile_already_bind_another_wechat_account:"此手机号或微信号已被其他会员账号绑定，请重新输入",this_mobile_exist_in_store:"该手机号在商城存在，不能绑定"};
function checkRegisterEmail(){var f=$("#loginEmail");var g=f.val();var a=true;var c="";if(g){if(!checkEmail(g)){a=false;c=loxia.getLocaleMsg("message_email_format_err")}else{var b=base+"/member/checkLoginEmailAvailable.json";var e=loxia.syncXhrGet(b,{email:g});if(!e.result){if(e.statusCode=="register.loginemail.unavailable"){a=false;c=loxia.getLocaleMsg("message_re_register")}else{if(e.statusCode=="member.email.error"){a=false;c=loxia.getLocaleMsg("message_email_format_err")}else{if(e.statusCode=="system.error"){a=false;c=loxia.getLocaleMsg("message_system_error")}else{if(e.statusCode=="system.error"){a=false;c=loxia.getLocaleMsg("message_system_error")}}}}}}}else{a=false;c=loxia.getLocaleMsg("message_enter_email")}setValid(f,a,c);return a}function checkHasSubscriptionEmail(c){var e=c.val();var a=true;var b="";if(e){if(!checkEmail(e)){a=false;b=loxia.getLocaleMsg("message_email_error")}}else{a=false;b=loxia.getLocaleMsg("message_email_null")}setValid(c,a,b);return a}function checkHasRegisterEmail(f){var g=f.val();var a=true;var c="";if(g){if(!checkEmail(g)){a=false;c=loxia.getLocaleMsg("message_email_error")}else{var b=base+"/member/checkLoginEmailAvailable.json";var e=loxia.syncXhrGet(b,{email:g});if(e.result){a=false;c=loxia.getLocaleMsg("message_forgetpassword_email")}}}else{a=false;c=loxia.getLocaleMsg("message_email_null")}setValid(f,a,c)}function checkforgetMobile(){var b=$("#loginMobilePhone");var h=b.val();var a=true;var c="";if(h){var f=/^[1][3,4,5,6,7,8,9][0-9]{9}$/;if(!f.test(h)){a=false;c=loxia.getLocaleMsg("message_mobile_number_error")}else{var g=base+"/member/checkLoginmobileAvailable.json";var e=loxia.syncXhrGet(g,{mobile:h});if(e.result){a=false;c="该电话号码未被注册，请重新输入"}}}else{a=false;c=loxia.getLocaleMsg("message_enter_mobile")}setValid(b,a,c)}function checkRandomCode(){var a=true;var c="";var b=$("#randomCode");if(!b.val()){a=false;c=loxia.getLocaleMsg("message_enter_description")}setValid(b,a,c);return a}function checkSecurityCode(){var a=$("#SecurityCode");if(!a.val()){setValid(a,false,loxia.getLocaleMsg("message_mobile_null"));return}setValid(a,true,"")}function checkMyEmail(){var c=$("#checkEmail");var e=c.val();var a=true;var b="";if(e){if(!checkEmail(c.val())){a=false;b=loxia.getLocaleMsg("message_email_error")}}else{a=false;b=loxia.getLocaleMsg("message_enter_email")}setValid(c,a,b)}function checkRegisterMobile(){var b=$("#loginMobile");var h=b.val();var a=true;var c="";if(h){var f=/^[1][3,4,5,6,7,8,9][0-9]{9}$/;if(!f.test(h)){a=false;c=loxia.getLocaleMsg("message_phone_format_err")}else{h=perfectMobile(h);var g=base+"/member/checkLoginmobileAvailable.json";var e=loxia.syncXhrGet(g,{mobile:h});if(!e.result){if(e.statusCode=="register.loginmobile.unavailable"){a=false;c=loxia.getLocaleMsg("message_member_has_bind_error")}else{if(e.statusCode="system.error"){a=false;c=loxia.getLocaleMsg("message_system_error")}}}}}else{a=false;c=loxia.getLocaleMsg("message_enter_mobile")}setValid(b,a,c);return a}function checkMobile(b){var f=b.val();var a=true;var c="";if(f){var e=/^[1][3,4,5,6,7,8,9][0-9]{9}$/;if(!e.test(f)){a=false;c=loxia.getLocaleMsg("message_phone_format_err")}}else{a=false;c=loxia.getLocaleMsg("message_enter_mobile")}setValid(b,a,c);return a}function checkdOldPwd(){var a=$("#oldpassword");var b=true;var c="";if(a.val()){if(!isPassword(a.val())){b=false;c=loxia.getLocaleMsg("message_pwd_characters")}}else{b=false;c=loxia.getLocaleMsg("message_enter_old_pwd")}setValid(a,b,c)}function isPassword(a){var b=/^(?=.*[a-zA-Z])(?=.*\d)(?=.*[~!@#$%^&*()_+`\-={}:";'<>?,.\/]*).{8,20}$/;if(b.exec(a)){return true}return false}function checkPwdNoHint(){var b=$("#password");var a=true;var c="";if(!b.val()){a=false;c=loxia.getLocaleMsg("message_enter_pwd")}setValid(b,a,c)}function checkNewPwd(){var b=$("#password");var a=true;var c="";if(b.val()){if(!isPassword(b.val())){a=false;c=loxia.getLocaleMsg("message_pwd_characters")}}else{a=false;c=loxia.getLocaleMsg("message_enter_new_pwd")}setValid(b,a,c)}function checkCurrentPwd(){var b=$("#password");var a=true;var c="";if(b.val()){if(!isPassword(b.val())){a=false;c=loxia.getLocaleMsg("message_pwd_characters")}}else{a=false;c=loxia.getLocaleMsg("message_enter_old_pwd")}setValid(b,a,c)}function checkChangePwd(){var b=$("#oldpassword");var c=$("#password");var a=true;var e="";if(c.val()){if(!isPassword(c.val())){a=false;e=loxia.getLocaleMsg("message_pwd_characters")}if(c.val()==b.val()){a=false;e=loxia.getLocaleMsg("message_old_new_pwd_error")}}else{a=false;e=loxia.getLocaleMsg("message_enter_new_pwd")}setValid(c,a,e)}function checkRePassword(){var e=$("#repassword");var b=$("#password").val();var a=true;var c="";if(e.val()){if(e.val()!=b){a=false;c=loxia.getLocaleMsg("message_enter_same_pwd")}}else{a=false;c=loxia.getLocaleMsg("message_enter_confirm_pwd")}setValid(e,a,c)}function checkRePwd(){var e=$("#rePassword");var b=$("#newpassword").val();var a=true;var c="";if(e.val()){if(e.val()!=b){a=false;c=loxia.getLocaleMsg("message_enter_same_pwd")}}else{a=false;c=loxia.getLocaleMsg("message_enter_confirm_pwd")}setValid(e,a,c)}function checkBirthDate(){var b=$("#birthDate");var c=b.val();var a=true;var e="";if(c){if(c==0){a=false;e=loxia.getLocaleMsg("message_select_birthday")}}else{a=false;e=loxia.getLocaleMsg("message_select_birthday")}setValid(b,a,e)}function checkStaffNO(){var b=$("#staffNO");var g=b.val();var a=true;var e="";if(g){var c=base+"/member/checkStaffNo.json";var f=loxia.syncXhrGet(c,{staffNo:g});if(!f.result){if(f.statusCode=="staffNO.unavailable"){a=false;e="員工編號不存在或已被登記"}}}else{a=false;e="請輸入您的員工編號 "}setValid(b,a,e)}function checkStaffName(){var c=$("#staffName");var i=$("#staffNO").val();var b=c.val();var a=true;var g="";if(b){var f=base+"/member/checkStaffName.json";var e={staffNo:i,staffName:b};var h=loxia.syncXhrPost(f,e);if(!h.result){if(h.statusCode=="staffName.unavailable"){a=false;g=loxia.getLocaleMsg("message_surname_err")}}}else{a=false;g=loxia.getLocaleMsg("message_enter_staffName")}setValid(c,a,g)}function setValid(e,a,c){if(c=="该电子邮箱地址已被登记，"||c=="该电话号码已经被登记，"){c=c+'<a href="/member/login">登入</a>'}if(c=="This email is already registered,"||c=="This phone No. is already registered,"){c=c+'<a href="/member/login">Login</a>'}$(e).data("checked",a);var b=$(e).parents("div.form-input:first");b.find(".msg-block").find("span").html(c);if(a){b.removeClass("is-error")}else{b.addClass("is-error")}}function perfectMobile(a){var b=$("#country").val();if(b){a=b+" "+a}return a}function checkSMSCode(){var a=true;var b="";var c=$("#smsCode");if(!c.val()){a=false;b=loxia.getLocaleMsg("message_enter_msgdescription")}setValid(c,a,b);return a}function checkLoginName(){var e=$("#loginName");var b=e.val();var a=true;var c="";if(b){if(!(checkEmail(b)||checkMobile(e))){a=false;c=loxia.getLocaleMsg("message_loginName_format_err")}}else{a=false;c=loxia.getLocaleMsg("message_enter_mailorphone")}setValid(e,a,c);return a}function checkPwd(){var b=$("#password");var a=true;var c="";if(b.val()){if(!isPassword(b.val())){a=false;c=loxia.getLocaleMsg("message_pwd_characters")}}else{a=false;c=loxia.getLocaleMsg("message_enter_pwd")}setValid(b,a,c)}function checkRePassword(){var e=$("#repassword");var b=$("#password").val();var a=true;var c="";if(e.val()){if(e.val()!=b){a=false;c=loxia.getLocaleMsg("message_enter_same_pwd")}}else{a=false;c=loxia.getLocaleMsg("message_enter_confirm_pwd")}setValid(e,a,c)}function checkGender(){var b=true;var e="";$("#gender_error_div").removeClass("is-error");$("#gender_error_msg").find("span").html("");if(!isMobile()){var c=$(".events-dropdown a").find("span");if(c.text().search("男")!=-1){e=1}else{if(c.text().search("女")!=-1){e=2}else{if(c.text().search("Male")!=-1){e=1}else{if(c.text().search("Female")!=-1){e=2}else{b=false;$("#gender_error_div").addClass("is-error");$("#gender_error_msg").find("span").html(loxia.getLocaleMsg("message_error_gender"))}}}}}else{var c=$(".events-form-select a").find("span");if(c.text().search("男")!=-1){e=1}else{if(c.text().search("女")!=-1){e=2}else{if(c.text().search("Male")!=-1){e=1}else{if(c.text().search("Female")!=-1){e=2}else{b=false;$("#gender_error_div").addClass("is-error");$("#gender_error_msg").find("span").html(loxia.getLocaleMsg("message_error_gender"))}}}}}var a={flag:b,gender:e};return a}function checkAddress(){var c=true;var f=$("#provinceVal").val();var b=$("#province").val();var g=$("#cityVal").val();var e=$("#city").val();if(b){if(e){c=true;$("#city_error_div").removeClass("is-error");$("#city_error_msg").find("span").html("");$("#province_error_div").removeClass("is-error");$("#province_error_msg").find("span").html("")}else{c=false;$("#city_error_div").addClass("is-error");$("#city_error_msg").find("span").html(loxia.getLocaleMsg("message_error_city"));$(".is-error .form-select.is-error .msg-block").css("display","block");$("#province_error_div").removeClass("is-error");$("#province_error_msg").find("span").html("")}}else{c=false;$("#province_error_div").addClass("is-error");$("#province_error_msg").find("span").html(loxia.getLocaleMsg("message_error_province"));$("#city_error_div").addClass("is-error");$("#city_error_msg").find("span").html(loxia.getLocaleMsg("message_error_city"));$(".is-error .form-select.is-error .msg-block").css("display","block")}var a={flag:c,province:b,provinceId:f,city:e,cityId:g};return a}function FormatDate(b){var a=new Date(b);return a.getFullYear()+"-"+(a.getMonth()+1)+"-"+a.getDate()}function checkBirthDay(){var b=true;var g="";var f=$("#year").val();var h=$("#month").val();var e=$("#day").val();var c=new Date();if(f&&f!=loxia.getLocaleMsg("message_select_year")){if(h&&h!=loxia.getLocaleMsg("message_select_month")){if(e&&e!=loxia.getLocaleMsg("message_select_day")){g=f+"-"+h+"-"+e;if(new Date(g)>c){b=false;$("#day_error_div").addClass("is-error");$("#day_error_msg").find("span").html(loxia.getLocaleMsg("message_birthday_Error"))}else{b=true}}else{b=false;$("#day_error_div").addClass("is-error");$("#day_error_msg").find("span").html(loxia.getLocaleMsg("message_error_day"))}}else{b=false;$("#mouth_error_div").addClass("is-error");$("#mouth_error_msg").find("span").html(loxia.getLocaleMsg("message_error_month"));$("#day_error_div").addClass("is-error");$("#day_error_msg").find("span").html(loxia.getLocaleMsg("message_error_day"))}}else{b=false;$("#year_error_div").addClass("is-error");$("#year_error_msg").find("span").html(loxia.getLocaleMsg("message_error_year"));$("#mouth_error_div").addClass("is-error");$("#mouth_error_msg").find("span").html(loxia.getLocaleMsg("message_error_month"));$("#day_error_div").addClass("is-error");$("#day_error_msg").find("span").html(loxia.getLocaleMsg("message_error_day"))}if(jsGetAge(g)<14){b=false;$("#year_error_div").addClass("is-error");$("#year_error_msg").find("span").html(loxia.getLocaleMsg("must_be_older_than_18"))}if(f==""||h==""||e==""){$(".events-ymd-default").removeClass("is-error")}var a={flag:b,birthday:g};return a}function checkNickName(){var g=$("#nickName");var a=g.val();var b=true;var e="";if(a){var f=/^[\u4e00-\u9fa5a-zA-Z ]+$/;if(!f.test(a)){b=false;e=loxia.getLocaleMsg("message_nickName_format_err")}else{var c=strlen(a);if(c>20){b=false;e=loxia.getLocaleMsg("message_nameLength_Error")}}}else{b=false;e=loxia.getLocaleMsg("message_nickName_err")}setValid(g,b,e);return b}function checkAddress(){var c=true;var f=$("#provinceVal").val();var b=$("#province").val();var g=$("#cityVal").val();var e=$("#city").val();if(b){if(e){c=true;$("#city_error_div").removeClass("is-error");$("#city_error_msg").find("span").html("");$("#province_error_div").removeClass("is-error");$("#province_error_msg").find("span").html("")}else{c=false;$("#city_error_div").addClass("is-error");$("#city_error_msg").find("span").html(loxia.getLocaleMsg("message_error_city"));$(".is-error .form-select.is-error .msg-block").css("display","block");$("#province_error_div").removeClass("is-error");$("#province_error_msg").find("span").html("")}}else{c=false;$("#province_error_div").addClass("is-error");$("#province_error_msg").find("span").html(loxia.getLocaleMsg("message_error_province"));$("#city_error_div").addClass("is-error");$("#city_error_msg").find("span").html(loxia.getLocaleMsg("message_error_city"));$(".is-error .form-select.is-error .msg-block").css("display","block")}var a={flag:c,province:b,provinceId:f,city:e,cityId:g};return a}function FormatDate(b){var a=new Date(b);return a.getFullYear()+"-"+(a.getMonth()+1)+"-"+a.getDate()}function checkAgreement(){var a=true;if(!$("#agreement").hasClass("is-active")){$("#agreement_error_div").addClass("is-error");$("#agreement_error_msg").find("span").html(loxia.getLocaleMsg("message_check_agreement"));a=false}else{$("#agreement_error_div").removeClass("is-error");$("#agreement_error_msg").find("span").html("");a=true}return a}function checkAdidasClub(){var a=true;if(!$("#agreementParty").hasClass("is-active")){$("#agreementParty_error_div").addClass("is-error");$("#agreementParty_error_msg").find("span").html(loxia.getLocaleMsg("message_check_agreement"));a=false}else{$("#agreementParty_error_div").removeClass("is-error");$("#agreementParty_error_msg").find("span").html("");a=true}return a}function checkStrIsNotNull(a){if(a==null||a.length==0||a==""){return false}else{return true}}function setValid(e,a,c){$(e).data("checked",a);var b=$(e).parents("div.form-input:first");b.find(".msg-block").find("span").html(c);if(a){b.removeClass("is-error")}else{b.addClass("is-error")}}function isMobile(){var a=false;if((navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i))){a=true}return a}function changeValidateCode(){var a=$("#captcha_pc_login_CaptchaImage");console.log(a);var e=a.attr("src");var c=e.indexOf("&time");var b=c!=-1;if(b){e=e.substring(0,c)}a.attr("src",e+"&time="+new Date().getTime())}function jsGetAge(f){var b;var a=f.split("-");var m=a[0];var g=a[1];var l=a[2];d=new Date();var c=d.getFullYear();var e=d.getMonth()+1;var k=d.getDate();if(c==m){b=0}else{var i=c-m;if(i>0){if(e==g){var h=k-l;if(h<0){b=i-1}else{b=i}}else{var j=e-g;if(j<0){b=i-1}else{b=i}}}else{b=-1}}return b}function checkNeteaseCaptcha(b){var a=checkStrIsNotNull(b);if(a){$(".verification-btn").find(".msg-block span").html("");$(".verification-btn").removeClass("is-error")}else{$(".verification-btn").find(".msg-block span").html(loxia.getLocaleMsg("message_verificationCode_Error"));$(".verification-btn").addClass("is-error")}return a}function destoryNeteaseCaptcha(a){$(".verification-btn").find(".msg-block span").html(loxia.getLocaleMsg("message_verificationCode_Error"));$(".verification-btn").addClass("is-error");initNECaptcha({captchaId:captchaId_register,element:"'"+a+"'",mode:"float",},function b(c){destory()},onerror)}function refreshNeteaseCaptcha(a){$(".verification-btn").find(".msg-block span").html(loxia.getLocaleMsg("message_verificationCode_Error"));$(".verification-btn").addClass("is-error");initNECaptcha({captchaId:captchaId_register,element:"#"+a,mode:"float"},function b(c){refresh()},onerror)}function strlen(e){var a=0;for(var b=0;b<e.length;b++){var f=e.charCodeAt(b);if((f>=1&&f<=126)||(65376<=f&&f<=65439)){a++}else{a+=2}}return a};
var htmlData={shoppingCartLineMap:"",totalAmount:0,itemCount:-1,cartLineMax:10,editSign:false};var requestTimer=null;var tinyscrollbarFlag=false,cartSubMenuTime=null,cartSubMenuLeaveTime=null;$(function(){if(cart_num.operation.getCartCount()>0){$(".header-cart").addClass("is-hover")}$(".events-spice-standard .header-cart a").live("mouseenter",function(){$(this).parent(".header-cart").addClass("is-hover")}).live("mouseleave",function(){if(cart_num.operation.getCartCount()<=0){setTimeout(function(){$(".header-cart").removeClass("is-hover")},1000)}});$(document).on("mouseenter",".events-spice-standard .header-cart",function(){var c=$(this);var a=window.location.pathname;if(a.indexOf("shoppingcart")>=0){return}var b=cart_num.operation.getCartCount();console.log("cookie : "+b);if(b!=htmlData.itemCount||htmlData.editSign){requestBackgroundData(function(e){htmlData.editSign=false;e.itemCount=b;var d=localHandlerbars.getTemplateHtml($("#mini-shopping-cart-template").html(),e);$("#for-template").html(d);$.spice.tinyscrollbar(".events-mincart-tinyscrollbar",{wheelLock:true,touchLock:false,callBack:function(f){}});refreshAllData(e);spreadMiniShoppingCart(c)})}spreadMiniShoppingCart(c)}).on("mouseleave",".events-spice-standard .header-cart",function(){var a=$(this);cartSubMenuTime&&clearTimeout(cartSubMenuTime);cartSubMenuLeaveTime&&clearTimeout(cartSubMenuLeaveTime);cartSubMenuLeaveTime=setTimeout(function(){a.find(".minicart-box").stop(true,true).slideUp("fast")},600)});$(document).on("mouseenter",".events-spice-standard .header-cart",function(){$(this).parent(".header-cart").addClass("is-hover")}).live("mouseleave",function(){setTimeout(function(){$(".header-cart").removeClass("is-hover")},1000)});$(".e-minicart-checkbox-select-all").live("tap",function(){if($("#all-select-icon").hasClass("is-disabled")){return}var h=$(this),a=$(".icon-checked-min-cart",h),e=$(".events-mincart-tinyscrollbar"),d=$("> .viewport > .overview > ul > li .e-checkbox",e),g=$(".icon-checked-min-cart",e),f=false;if(a.hasClass("is-active")){a.removeClass("is-active");g.removeClass("is-active");f=false}else{a.addClass("is-active");g.addClass("is-active");f=true}for(var b in htmlData.shoppingCartLineMap){var c=htmlData.shoppingCartLineMap[b];if(c.status!="ITEM_LIFECYCLE_OFF_SHELF"&&c.status!="OUT_OF_STOCK"&&!c.extraData.isVipRoomProduct){htmlData.shoppingCartLineMap[b].checked=f}}loxia.asyncXhrPost(base+"/shoppingcart/select.json",{checked:f},{success:function(i){requestBackgroundData(refreshAllData);if(!i.result){alert("系统错误")}},error:function(i){console.log(i);requestBackgroundData(refreshAllData)}})});$(".events-mincart-tinyscrollbar .e-checkbox").live("tap",function(){var d=$(this),b=$(".icon-checked-min-cart",d),c=d.parents(".events-mincart-tinyscrollbar"),a=$("> .viewport > .overview > ul",c);$itemElem=$("> li",a),itemElemLen=$itemElem.length,lineId=d.attr("lineId");if(b.hasClass("is-active")){b.removeClass("is-active");htmlData.shoppingCartLineMap[lineId].checked=false}else{b.addClass("is-active");htmlData.shoppingCartLineMap[lineId].checked=true}if(a.find("> li .e-checkbox .icon-checked-min-cart.is-active").length===itemElemLen){$(".e-minicart-checkbox-select-all .icon-checked-min-cart").addClass("is-active")}else{$(".e-minicart-checkbox-select-all .icon-checked-min-cart").removeClass("is-active")}clearTimeout(requestTimer);requestTimer=setTimeout(function(){selectOneLine(lineId,htmlData.shoppingCartLineMap[lineId].checked)},500)});$(".btn-minus").live("tap",function(){if($(this).hasClass("is-disabled")){return}var a=$(this).parent().attr("lineId");var c=htmlData.shoppingCartLineMap[a].quantity;if(c<=1||htmlData.shoppingCartLineMap[a].stock==0){return}var b=0;if(htmlData.shoppingCartLineMap[a].status=="OUT_OF_STOCK"&&htmlData.shoppingCartLineMap[a].quantity>htmlData.shoppingCartLineMap[a].stock){b=htmlData.shoppingCartLineMap[a].stock}else{b=c-1}$(this).next().val(b);if(b<=1){$(this).addClass("is-disabled")}$(this).siblings(".events-plus").removeClass("is-disabled");htmlData.shoppingCartLineMap[a].quantity=b;htmlData.itemCount-=1;$(".shop-num").html(htmlData.itemCount);$("#priceNum"+a).html("x "+b);clearTimeout(requestTimer);requestTimer=setTimeout(function(){changeItemCount(a,htmlData.shoppingCartLineMap[a].quantity)},500)});$(".events-plus").live("tap",function(){if($(this).hasClass("is-disabled")){return}var a=$(this).parent().attr("lineId");var d=0;htmlData.shoppingCartLineMap[a].stock>10?d=10:d=htmlData.shoppingCartLineMap[a].stock;var c=htmlData.shoppingCartLineMap[a].quantity;if(c>=d){return}var b=c+1;$(this).prev().val(b);if(b>=d){$(this).addClass("is-disabled")}$(this).siblings(".events-minus").removeClass("is-disabled");htmlData.shoppingCartLineMap[a].quantity=b;htmlData.itemCount+=1;$(".shop-num").html(htmlData.itemCount);$("#priceNum"+a).html("x "+b);clearTimeout(requestTimer);requestTimer=setTimeout(function(){changeItemCount(a,htmlData.shoppingCartLineMap[a].quantity)},500)});$(".events-input").live("blur",function(){var e=$(this);var a=e.parent().attr("lineId");var b=parseInt(e.val());var d=htmlData.shoppingCartLineMap[a];if(d.status=="ITEM_LIFECYCLE_OFF_SHELF"||d.extraData.isVipRoomProduct||d.stock==0){e.val(d.quantity);return}if(b==d.quantity){return}if(b<1){htmlData.shoppingCartLineMap[a].quantity=1;e.val(1)}var c=0;d.stock>10?c=10:c=d.stock;if(b>c){htmlData.shoppingCartLineMap[a].quantity=c;e.val(c)}if(b>=1&&b<=c){htmlData.shoppingCartLineMap[a].quantity=b}if(htmlData.shoppingCartLineMap[a].quantity>=c){e.next().addClass("is-disabled")}else{e.next().removeClass("is-disabled")}if(htmlData.shoppingCartLineMap[a].quantity<=1){e.prev().addClass("is-disabled")}else{e.prev().removeClass("is-disabled")}changeItemCount(a,htmlData.shoppingCartLineMap[a].quantity)});$(document).on("tap",".header-cart .events-mincart-del",function(){var c=$(this);var b=c.attr("lineId");var a=loxia.syncXhrPost(base+"/shoppingcart/delete.json",{shoppingcartLineId:b});if(a.result){$(window).trigger("resize.cartRightFixed");htmlData.itemCount-=c.attr("quantity");$(".shop-num").html(htmlData.itemCount);if(htmlData.shoppingCartLineMap[b].status!="ITEM_LIFECYCLE_OFF_SHELF"&&htmlData.shoppingCartLineMap[b].status!="OUT_OF_STOCK"&&!htmlData.shoppingCartLineMap[b].extraData.isVipRoomProduct){htmlData.totalAmount-=c.attr("subTotalAmt");$("#total_amount").html("¥"+htmlData.totalAmount.toFixed(2))}delete htmlData.shoppingCartLineMap[b];refreshAllData(htmlData);c.parents(".mincart-item").parent("li").animate({opacity:0},300,function(){c.parents(".mincart-item").parent("li").remove();$(".events-mincart-tinyscrollbar").data("spice.tinyscrollbar")&&$(".events-mincart-tinyscrollbar").data("spice.tinyscrollbar").update();var d=$(".events-mincart-tinyscrollbar ul li").length;$(".header-cart > a span").html(d);if(d==0){$(".header-cart .minicart-box").stop(true,true).slideUp("fast")}})}else{if(a.statusCode==="system.busy"){alert("系统繁忙")}else{alert("系统错误")}}});$(".mincart-btn").live("tap",function(){var g=$(this);if(htmlData.itemCount<=0){g.find("span").html("购物车为空！");g.addClass("is-error")}else{var f=loxia.syncXhrPost(base+"/shoppingcart/validateCheckout.json",{});if(f.result){window.location.href=base+"/transaction/check"}else{if(f.resultMessage&&f.resultMessage.message==="SHOPPING_CART_LINE_COMMAND_NOT_FOUND"){g.addClass("is-error");setTimeout(function(){g.removeClass("is-error")},3000)}else{if(f.resultMessage.message=="BUY_LIMIT"){var a=f.resultMessage.params[0].historyBuy;var e=f.resultMessage.params[0].limitQuantity;var b=f.resultMessage.params[0].count;var c=f.resultMessage.params[1];var d=a?c+" 限购"+e+"件，您已购买过"+a+"件":c+"限购"+e+"件";g.find("div span").html(d);g.addClass("is-error");setTimeout(function(){g.removeClass("is-error")},3000)}else{alert("商品状态已改变，请刷新页面后重试")}}}}})});function refreshAllData(g){var j=$("#all-select-icon");j.removeClass("is-disabled");var d=0;var c=0;for(var i in g.shoppingCartLineMap){var f=g.shoppingCartLineMap[i];var a=$("#selectBox"+f.id);a.removeClass("is-disabled");if(f.checked){a.addClass("is-active");var b=f.extraData.personalized?f.extraData.personalized.fee:0;d+=f.salePrice*f.quantity+b}else{a.removeClass("is-active")}var h=$("#plueAndMines"+f.id);if(!f.isGift&&(f.status=="ITEM_LIFECYCLE_OFF_SHELF"||(f.status=="OUT_OF_STOCK"&&f.quantity>f.stock)||f.extraData.isVipRoomProduct||f.disabled)){a.addClass("is-disabled");if(!j.hasClass("is-disabled")){j.addClass("is-disabled")}}else{if(!f.isGift&&f.status=="NORMAL"){h.parent().next(".info-stock").remove()}if(f.checked){c++}}if(f.status=="ITEM_LIFECYCLE_OFF_SHELF"||f.extraData.isVipRoomProduct||f.stock==0){h.children("a").addClass("is-disabled")}else{var e=f.extraData.maxQuantity;if(f.quantity>=e){h.children(".events-plus").addClass("is-disabled")}else{h.children(".events-plus").removeClass("is-disabled")}if(f.quantity<=1){h.children(".events-minus").addClass("is-disabled")}else{h.children(".events-minus").removeClass("is-disabled")}}h.children("input").val(f.quantity);h.next().children(".price-num").html("x "+f.quantity);if(f.extraData.personalized){h.prev().children().html(f.extraData.personalized.fee)}}$("#total_amount").html("¥"+d.toFixed(2));$(".shop-num").html(htmlData.itemCount);if(c==Object.keys(g.shoppingCartLineMap).length){j.addClass("is-active")}}function changeItemCount(a,f){var e=htmlData.shoppingCartLineMap[a];var c={shoppingcartLineId:a,count:f};if(e.extraData.personalized){var b=e.extraData.personalized.parts;var d=JSON.parse(b);perlize.config.code=e.itemCode;perlize.config.style=e.extraData.item.style;perlize.utils.generateImages(d,{sku:e.skuId+"",quantity:f,countrySize:e.extraData.personalized.countrySize,size:e.extraData.size},null,false);console.log("perlize.attr.previewImage::",perlize.attr.previewImage);perlize.utils.saveItem();c.recipeId=perlize.attr.metaId;c.skuId=e.skuId;loxia.asyncXhrPost(base+"/shoppingcart/updateSize.json",c,{success:function(g){if(g.result){requestBackgroundData(refreshAllData);return true}else{if(g.statusCode==="system.busy"){requestBackgroundData(refreshAllData);alert("系统繁忙")}else{if(g.resultMessage.message=="MAX_THAN_INVENTORY"){alert("库存不足")}else{requestBackgroundData(refreshAllData);alert("系统错误")}}}},error:function(g){console.log(g);requestBackgroundData(refreshAllData);alert("请求失败")}})}else{loxia.asyncXhrPost(base+"/shoppingcart/update.json",c,{success:function(g){console.log(g);if(g.result){requestBackgroundData(refreshAllData);return true}else{if(g.resultMessage.message=="MAX_THAN_INVENTORY"){alert("库存不足")}else{requestBackgroundData(refreshAllData);alert("系统错误")}}},error:function(g){console.log(g);requestBackgroundData(refreshAllData);alert("请求失败")}})}}function selectOneLine(a,c){var b={shoppingcartLineId:a,checked:c};loxia.asyncXhrPost(base+"/shoppingcart/selectone.json",b,{success:function(d){requestBackgroundData(refreshAllData)},error:function(d){console.log(d);requestBackgroundData(refreshAllData)}})}function requestBackgroundData(a){loxia.asyncXhrGet(base+"/miniShoppingCart.json",null,{success:function(b){htmlData.itemCount=cart_num.operation.getCartCount();console.log(b);if(!b){return}htmlData.shoppingCartLineMap=b.shoppingCartLineMap;htmlData.totalAmount=b.totalAmount;htmlData.cartLineMax=b.cartLineMax;htmlData.shoppingCartLineArray=sortByAddTime(b.shoppingCartLineMap);a(htmlData);$(document).find(".mincart-content > div ul li .mincart-img img").addClass("open");$.spice.lazyLoad(".open[lazysrc],img[lazysrc]:not(.header-fixed img)",{attr:"lazysrc"})},error:function(b){console.log(b)}})}function spreadMiniShoppingCart(b){var a=$(".events-mincart-tinyscrollbar ul li").length;if(a>0){if(b.find(".minicart-box").length){cartSubMenuTime&&clearTimeout(cartSubMenuTime);cartSubMenuLeaveTime&&clearTimeout(cartSubMenuLeaveTime);cartSubMenuTime=setTimeout(function(){b.find(".minicart-box").stop(true,true).slideDown("fast");if(!tinyscrollbarFlag){$.spice.tinyscrollbar(".events-mincart-tinyscrollbar",{wheelLock:true,touchLock:false,callBack:function(c){}});tinyscrollbarFlag=true}$(".events-mincart-tinyscrollbar").data("spice.tinyscrollbar")&&$(".events-mincart-tinyscrollbar").data("spice.tinyscrollbar").update()},100)}}}function sortByAddTime(g){var f=[];for(var d in g){f.push(g[d])}var e=f.length;for(var c=0;c<e;c++){for(var b=0;b<e-c-1;b++){if(parseInt(f[b].addTime)<parseInt(f[b+1].addTime)){var a=f[b];f[b]=f[b+1];f[b+1]=a}}}return f};
var irclickid="irclickid";var IMPACT_VISIT_URL="/impact/visit.json";$(function(){var a=window.location.href;if(a.indexOf(irclickid)!=-1){var b={href:a};var c=loxia.syncXhrPost(base+IMPACT_VISIT_URL,b);console.log(JSON.stringify(c))}});
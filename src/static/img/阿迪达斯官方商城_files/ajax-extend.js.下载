var isReturn=false;(function(c){var b=getCookie("XSRF-TOKEN");if(typeof(b)==="undefined"||null==b){c.post("/ping.json?"+new Date().getTime(),function(d){b=getCookie("XSRF-TOKEN")})}var a=c.ajax;c.ajax=function(d){var f={error:function(g,i,h){},success:function(g,h){}};if(d.error){f.error=d.error}if(d.success){f.success=d.success}var e=c.extend(d,{error:function(g,i,h){f.error(g,i,h)},success:function(g,h){if(g&&g.denied){isReturn=true}else{f.success(g,h)}},beforeSend:function(g){if(typeof(b)!="undefined"){g.setRequestHeader("X-CSRF-TOKEN",b)}},complete:function(g,h){},cache:false});if(isReturn){isReturn=false;return false}else{a(e)}};c("form[method=post]").append(c("<input />").attr("name","_csrf").attr("type","hidden").val(b))})(jQuery);